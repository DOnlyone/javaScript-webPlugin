<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>购物车</title>
  <link href="fontsome/font-awesome.min.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery-1.11.2.min.js"></script>
  <link href="fontsome/shop-car.css" rel="stylesheet" type="text/css"/>
 </head>
 <body style="background:#f1f1f1">
	
	<div class="shop-header">
		<div class="wrap">
			<div class="header-logo fl"></div>
			<div class="header-title fl">
				<h2>我的购物车</h2>
			</div>
			<div class="userinfo fr"><i class="fa fa-user"></i>&nbsp;admin</div>
		</div>
	</div>

	<div class="shop_info">
		<div class="wrap">
			<div class="shop_goods_list">
                <div class="list-head clearfix">
                    <div class="col col-check"><i class="iconfont icon-checkbox icon-checkbox-selected" id="K_selectAll">√</i>全选</div>
                    <div class="col col-img">&nbsp;</div>
                    <div class="col col-name">商品名称</div>
                    <div class="col col-price">单价</div>
                    <div class="col col-num">数量</div>
                    <div class="col col-total">小计</div>
                    <div class="col col-action">操作</div>
                </div>
                <div class="list-body" id="K_cartListBody">  
				
					


					<div class="item-box"> 
						<div class="item-table K_cartGoods"> 
							<div class="item-row clearfix"> 
								<div class="col col-check">  
									<i class=" icon-checkbox icon-checkbox-selected">√</i>  
								</div> 
								<div class="col col-img">  
									<a href="http://item.mi.com/1134900527.html" target="_blank"> 
										<img alt="" src="http://i1.mifile.cn/a1/T1sRhTBsYT1RXrhCrK!80x80.jpg" width="80" height="80"> 
									</a>  
								</div> 
								<div class="col col-name">  
									<div class="tags"> </div>  
									<h3 class="name">  
										<a href="http://item.mi.com/1134900527.html" target="_blank"> SanDisk 16GB存储卡（Class4） 黑色 </a>  
									</h3>   
									<p class="desc"> <span>适配机型：</span> 小米平板 / 1 / 1S, 红米1S/红米, 红米Note/增强版, 红米手机2, 红米手机2A </p>
								</div> 
								<div class="col col-price"><i class="fa fa-cny"></i>2元 </div> 
								<div class="col col-num">  
									<div class="change-goods-num clearfix K_changeGoodsNum"> 
										<a href="javascript:void(0)" class="K_minus fl"><i class="fa fa-minus"></i></a> 
										<input tyep="text" name="2134900590_0_buy" value="1"  autocomplete="off" class="goods-num K_goodsNum fl"> 
										<span class="s-num">1</span>
										<a href="javascript:void(0)" class="K_plus fr"><i class="fa fa-plus"></i></a>  
									</div>  
								</div> 
								<div class="col col-total"> <i class="fa fa-cny"></i>
								<span class="t_price">35.9</span>元 <p class="pre-info">  </p> </div> 
								<div class="col col-action"> 
									<a id="2134900590_0_buy" data-msg="确定删除吗？" href="javascript:void(0);" title="删除" class="del K_delGoods">
										<i class="fa fa-remove"></i>
									</a> 
								</div> 
							</div> 
						</div>
					</div>




					<div class="item-box"> 
						<div class="item-table K_cartGoods"> 
							<div class="item-row clearfix"> 
								<div class="col col-check">  
									<i class=" icon-checkbox icon-checkbox-selected">√</i>  
								</div> 
								<div class="col col-img">  
									<a href="http://item.mi.com/1134900527.html" target="_blank"> 
										<img alt="" src="http://i1.mifile.cn/a1/T1sRhTBsYT1RXrhCrK!80x80.jpg" width="80" height="80"> 
									</a>  
								</div> 
								<div class="col col-name">  
									<div class="tags"> </div>  
									<h3 class="name">  
										<a href="http://item.mi.com/1134900527.html" target="_blank"> SanDisk 16GB存储卡（Class4） 黑色 </a>  
									</h3>   
									<p class="desc"> <span>适配机型：</span> 小米平板 / 1 / 1S, 红米1S/红米, 红米Note/增强版, 红米手机2, 红米手机2A </p>
								</div> 
								<div class="col col-price"><i class="fa fa-cny"></i>3元 </div> 
								<div class="col col-num">  
									<div class="change-goods-num clearfix K_changeGoodsNum"> 
										<a href="javascript:void(0)" class="K_minus fl"><i class="fa fa-minus"></i></a> 
										<input tyep="text" name="2134900590_0_buy" value="1"  autocomplete="off" class="goods-num K_goodsNum fl"> 
										<span class="s-num">1</span>
										<a href="javascript:void(0)" class="K_plus fr"><i class="fa fa-plus"></i></a>  
									</div>  
								</div> 
								<div class="col col-total"> <i class="fa fa-cny"></i><span class="t_price">35.9</span>元 <p class="pre-info">  </p> </div> 
								<div class="col col-action"> 
									<a id="2134900590_0_buy" data-msg="确定删除吗？" href="javascript:void(0);" title="删除" class="del K_delGoods">
										<i class="fa fa-remove"></i>
									</a> 
								</div> 
							</div> 
						</div>
					</div>
				</div>  







				
            </div>
			<div class="cart-bar clearfix" id="K_cartBar">
					<div class="section-left">
						<a href="http://list.mi.com/0" class="back-shopping K_goShoping" data-stat-id="3d1e5bdd191768c8" onclick="_msq.push(['trackEvent', '08fae3d5cb3abaaf-3d1e5bdd191768c8', '#', 'pcpid']);">继续购物</a>
						<span class="cart-total">共 <i id="K_cartTotalNum">8</i> 件商品，已选择 <i id="K_selTotalNum">8</i> 件</span>
						<span class="cart-coudan hide" id="K_coudanTip">
							，还需 <i id="K_postFreeBalance"></i> 元即可免邮费  <a href="javascript:void(0);" id="K_showCoudan" data-stat-id="69b06f1a9d2d512c" onclick="_msq.push(['trackEvent', '08fae3d5cb3abaaf-69b06f1a9d2d512c', 'javascript:void(0);', 'pcpid']);">立即凑单</a>
						</span>
					</div>
					<span class="activity-money hide">
						活动优惠：减 <i id="K_cartActivityMoney">0</i> 元
					</span>
					<span class="total-price">
						合计（不含运费）：<em id="K_cartTotalPrice">375.80</em>元
					</span>
					<a href="javascript:void(0);" class="btn btn-a btn-primary" id="K_goCheckout" >去结算</a>

					<div class="no-select-tip hide" id="K_noSelectTip">
						请勾选需要结算的商品
						<i class="arrow arrow-a"></i>
						<i class="arrow arrow-b"></i>
					</div>
				</div>
		</div>


	</div>

	<script>
		$(function(){
			/*
				1:数字累加和递减
				2:总金额的计算
				3:选择控制金额，删除控制金额
				4:表头金额和数量的排序
				
			*/

			//减号事件
			$(".K_minus").on("click",function(){
				var $input =  $(this).next();
				var val = $input.val() * 1;
				var $span = $(this).next().next();
				if(val<=1)return;
				$span.text(--val).stop(true,true).animate({top:-38},480,function(){
					$input.val(val);
					$(this).css("top",38);
					//点击计算
					getTotal();
				});
			});

			//加号事件
			$(".K_plus").on("click",function(){
				var $input =  $(this).prev().prev();
				var val = $input.val() * 1;
				var $span = $(this).prev();
				$span.text(++val).stop(true,true).animate({top:-38},480,function(){
					$input.val(val);
					$(this).css("top",38);
					//点击计算
					getTotal();
				});
			});

			//删除事件
			$("#K_cartListBody").find(".fa-remove").on("click",function(){
				var $parents = $(this).parents(".item-box");
				$parents.fadeOut("slow",function(){
					$(this).remove();
					getTotal();
				});
			});
			
			//选择事件
			$("#K_cartListBody").find(".icon-checkbox").on("click",function(){
				$(this).toggleClass("icon-checkbox-selected");
				getTotal();
			});

			//第一次计算
			getTotal();
		});

		function countPrice(){
			//拿到盒子对象
			var $itemsbox = $("#K_cartListBody").children();
			//总金额的累加
			var total = 0;
			//循环所有的盒子
			$itemsbox.each(function(){
				//判断一个元素是否包含某一个className,如果包含返回true否则false
				var mark = $(this).find(".icon-checkbox").hasClass("icon-checkbox-selected");
				if(mark){
					//拿到盒子数量
					var val = $(this).find(".K_goodsNum").val();
					//拿到盒子的金额
					var price = parseFloat($(this).find(".col-price").text());
					//计算金额
					var cp = val * price;
					//小计计算
					$(this).find(".t_price").text(cp);
					//总金额的累加
					total = total + cp;
				}
			});

			//返回cpu计算的总金额=====执行函数是cpu去执行的。
			return total;
		};

			
		//计算总金额==当一种代码两次以上写封装起来.
		//不要为了封装而封装---刚不要考虑封装
		function getTotal(){
			//获取计算总金额
			var total = countPrice();
			//赋予目标盒子
			$("#K_cartTotalPrice").text("￥"+total);
		};
	</script>
 </body>
</html>
